be8e2350ee1c76ad2692ed8460d94541
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = globalTeardown;
// Global test teardown - runs once after all tests
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
async function globalTeardown() {
    console.log('üß™ Cleaning up global test environment...');
    // Clean up test database
    const testDbPath = process.env.DATABASE_PATH || path_1.default.join(__dirname, '../../data/test.sqlite');
    try {
        if (fs_1.default.existsSync(testDbPath)) {
            fs_1.default.unlinkSync(testDbPath);
            console.log('‚úÖ Test database cleaned up');
        }
        // Clean up WAL and SHM files if they exist
        const walFile = testDbPath + '-wal';
        const shmFile = testDbPath + '-shm';
        if (fs_1.default.existsSync(walFile))
            fs_1.default.unlinkSync(walFile);
        if (fs_1.default.existsSync(shmFile))
            fs_1.default.unlinkSync(shmFile);
    }
    catch (error) {
        console.error('‚ùå Error cleaning up test database:', error);
    }
    console.log('‚úÖ Global test teardown complete');
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL3dvcmtzcGFjZXMvcHJvbXB0LWNhcmQtc3lzdGVtL2JhY2tlbmQvc3JjL3Rlc3RzL2dsb2JhbFRlYXJkb3duLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBSUEsaUNBd0JDO0FBNUJELG1EQUFtRDtBQUNuRCw0Q0FBb0I7QUFDcEIsZ0RBQXdCO0FBRVQsS0FBSyxVQUFVLGNBQWM7SUFDMUMsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO0lBRXpELHlCQUF5QjtJQUN6QixNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsSUFBSSxjQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSx3QkFBd0IsQ0FBQyxDQUFDO0lBRS9GLElBQUksQ0FBQztRQUNILElBQUksWUFBRSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO1lBQzlCLFlBQUUsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDMUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1FBQzVDLENBQUM7UUFFRCwyQ0FBMkM7UUFDM0MsTUFBTSxPQUFPLEdBQUcsVUFBVSxHQUFHLE1BQU0sQ0FBQztRQUNwQyxNQUFNLE9BQU8sR0FBRyxVQUFVLEdBQUcsTUFBTSxDQUFDO1FBRXBDLElBQUksWUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7WUFBRSxZQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ25ELElBQUksWUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7WUFBRSxZQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRXJELENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxvQ0FBb0MsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM3RCxDQUFDO0lBRUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO0FBQ2pELENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL3dvcmtzcGFjZXMvcHJvbXB0LWNhcmQtc3lzdGVtL2JhY2tlbmQvc3JjL3Rlc3RzL2dsb2JhbFRlYXJkb3duLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEdsb2JhbCB0ZXN0IHRlYXJkb3duIC0gcnVucyBvbmNlIGFmdGVyIGFsbCB0ZXN0c1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBnbG9iYWxUZWFyZG93bigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc29sZS5sb2coJ/Cfp6ogQ2xlYW5pbmcgdXAgZ2xvYmFsIHRlc3QgZW52aXJvbm1lbnQuLi4nKTtcbiAgXG4gIC8vIENsZWFuIHVwIHRlc3QgZGF0YWJhc2VcbiAgY29uc3QgdGVzdERiUGF0aCA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1BBVEggfHwgcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uL2RhdGEvdGVzdC5zcWxpdGUnKTtcbiAgXG4gIHRyeSB7XG4gICAgaWYgKGZzLmV4aXN0c1N5bmModGVzdERiUGF0aCkpIHtcbiAgICAgIGZzLnVubGlua1N5bmModGVzdERiUGF0aCk7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIFRlc3QgZGF0YWJhc2UgY2xlYW5lZCB1cCcpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhbiB1cCBXQUwgYW5kIFNITSBmaWxlcyBpZiB0aGV5IGV4aXN0XG4gICAgY29uc3Qgd2FsRmlsZSA9IHRlc3REYlBhdGggKyAnLXdhbCc7XG4gICAgY29uc3Qgc2htRmlsZSA9IHRlc3REYlBhdGggKyAnLXNobSc7XG4gICAgXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMod2FsRmlsZSkpIGZzLnVubGlua1N5bmMod2FsRmlsZSk7XG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoc2htRmlsZSkpIGZzLnVubGlua1N5bmMoc2htRmlsZSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGNsZWFuaW5nIHVwIHRlc3QgZGF0YWJhc2U6JywgZXJyb3IpO1xuICB9XG4gIFxuICBjb25zb2xlLmxvZygn4pyFIEdsb2JhbCB0ZXN0IHRlYXJkb3duIGNvbXBsZXRlJyk7XG59Il0sInZlcnNpb24iOjN9